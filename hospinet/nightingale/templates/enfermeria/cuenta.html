{% extends 'base.html' %}
{% load l10n %}{% load staticfiles %}{% load humanize %}
{% block content %}
    <div class="row">
        <div class="span12 text-center">
            <div class="page-header">
                <h4>Estado de Cuenta</h4>
            </div>
        </div>
    </div>
    <div class="row">
        <section class="span12">
            <table class="table">
                <tr>
                    <td><h1>{{ admision.paciente.nombre_completo }}</h1></td>
                    <td></td>
                    <td>
                        <a class="btn btn-block no-print" href="{% url 'admision-invoice' admision.id %}">Facturar</a>
                        <div class="row">
                            <div class="span3">
                                <br />
                                <ul>
                                    <li>Cuenta {{ admision.id }}</li>
                                    <li>{{ fecha }}</li>
                                </ul>
                            </div>
                        </div>
                    </td>
                </tr>
            </table>
        </section>
    </div>
    <div class="row">
        <section class="span12 full-size-print">
            <table class="table table-striped table-bordered no-more-tables">
            <thead>
                <tr>
                    <th>C&oacute;digo</th>
                    <th>Cargo</th>
                    <th>Cantidad</th>
                    <th>Precio Unitario</th>
                    <th>Precio Valor Total</th>
                </tr>
            </thead>
                <tbody>
                <tr>
                    {% localize off %}
                        <td data-title="Código">{{ admision.habitacion.item.id }}</td>
                    {% endlocalize %}
                    <td data-title="Cargo">Hospitalizaci&oacute;n</td>
                    <td class="text-right" data-title="Tiempo">{{ admision.tiempo_cobro }}</td>
                    <td class="text-right" data-title="Precio Unitario">{{ admision.precio_diario|floatformat:2|intcomma }}</td>
                    <td class="text-right" data-title="Total">{{ admision.debido|floatformat:2|intcomma }}</td>
                </tr>
                {% for honorario in admision.honorarios.all %}
                    <tr>
                        {% localize off %}
                            <td data-title="Código">{{ honorario.item.id }}</td>
                        {% endlocalize %}
                        <td data-title="Cargo">{{ honorario.item }}</td>
                        <td>Médico: {{ honorario.medico }}</td>
                        <td class="text-right" data-title="Precio Unitario">{{ honorario.monto|floatformat:2|intcomma }}</td>
                        <td class="text-right" data-title="Total">{{ honorario.monto|floatformat:2|intcomma }}</td>
                    </tr>
                {% endfor %}
                {% for terapia in admision.oxigeno_terapias.all %}
                    <tr>
                        {% localize off %}
                            <td data-title="Código">{{ terapia.cargo.id }}</td>
                        {% endlocalize %}
                        <td data-title="Cargo">Oxigeno</td>
                        <td class="text-right" data-title="Tiempo">{{ terapia.tiempo }}</td>
                        <td class="text-right" data-title="Litros">{{ terapia.litros }}</td>
                        <td class="text-right" data-title="Total">{{ terapia.valor|floatformat:2|intcomma }}</td>
                    </tr>
                {% endfor %}
                {% for cargo, lista in admision.agrupar_cargos.items %}
                    <tr>
                        {% localize off %}
                            <td data-title="Código">{{ cargo.id }}</td>
                        {% endlocalize %}
                        <td data-title="Cargo">{{ cargo }}</td>
                        <td data-title="Cantidad" class="text-right">{{ lista.cantidad }}</td>
                        <td data-title="Precio Unitario" class="text-right">{{ lista.precio_unitario|floatformat:2|intcomma }}</td>
                        <td data-title="Total" class="text-right">{{ lista.valor|floatformat:2|intcomma }}</td>
                    </tr>
                {% endfor %}
                </tbody>
                <tfoot>
                <tr>
                    <th colspan="4">Total</th>
                    <th >{{ admision.estado_de_cuenta|floatformat:2|intcomma }}</th>
                </tr>
                </tfoot>
            </table>
        </section>
    </div>
{% endblock %}
