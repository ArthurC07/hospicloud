{% extends 'base.html' %}
{% load crispy_forms_tags %}
{% block content %}
    <div class="row">
        <div class="col-md-12">
            <div class="page-header">
                <h1>{{ consultorio.nombre }}
                    <small>Consultorio</small>
                </h1>
            </div>
            <div class="row">
                <section class="col-md-9">
                    <div class="main-content col-md-12">
                        <div class="row">
                            <div class="col-md-12">
                                <section class="page-header">
                                    <h2>
                                        En Consulta
                                        <small>Promedio de Espera Ultimo
                                            mes {{ total }} minutos
                                        </small>
                                    </h2>
                                </section>
                                {% load staticfiles %}{% load thumbnail %}
                                {% for espera in consultas %}
                                    {% include 'clinique/snippets/espera.html' with espera=espera %}
                                {% endfor %}
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-12">
                                <section class="page-header">
                                    <h2>
                                        Sala de Espera
                                        <small>Promedio de Espera Ultimo
                                            mes {{ total }} minutos
                                        </small>
                                    </h2>
                                </section>
                                {% for espera in page_obj %}
                                    {% include 'clinique/snippets/espera.html' with espera=espera %}
                                {% endfor %}
                            </div>
                        </div>
                        {% if is_paginated %}
                            {% load bootstrap_pagination %}
                            {% bootstrap_paginate page_obj range=10 show_prev_next="false" show_first_last='true' %}
                        {% endif %}
                        <div class="row">
                            <div class="col-md-12">
                                <section class="page-header">
                                    <h1>Citas de Hoy</h1>
                                </section>
                                {% for cita in citas.all %}
                                    <div class="col-md-12">
                                        <div class="row">
                                            <div class="col-md-2">
                                                <img src="{% static 'images/face.jpg' %}"
                                                     width="100" height="100"/>
                                            </div>
                                            <div class="col-md-9">
                                                <h3>{{ cita.persona }}
                                                    <small>{{ cita.persona.obtener_edad }}
                                                        a&ntilde;os
                                                    </small>
                                                </h3>
                                                <p>
                                                    {{ cita.persona.get_sexo_display }}
                                                    Programado para
                                                    el {{ cita.fecha }}
                                                </p>

                                                <p>
                                                    <a class="btn btn-success"
                                                       href="{% url 'consultorio-lectura-agregar' cita.persona.id %}">Agregar
                                                        Lectura de Signos</a>
                                                    <a class="btn btn-success"
                                                       href="{% url 'clinique-cita-espera' cita.id %}">Enviar
                                                        a Sala de Espera</a>
                                                    <a class="btn btn-primary"
                                                       href="{% url 'clinique-cita-ausente' cita.id %}">No
                                                        se Presentó a la
                                                        Cita</a>
                                                </p>
                                            </div>
                                        </div>
                                        <hr>
                                    </div>
                                {% endfor %}
                            </div>
                        </div>
                        {% if consultorio.especialista %}
                            <div class="row">
                                <div class="col-md-12 col-xs-12 table-responsive">
                                    <table class="table table-striped">
                                        <caption>Consultas Remitidas</caption>
                                        <thead>
                                        <tr>
                                            <th>Fecha</th>
                                            <th>Motivo de Consulta</th>
                                            <th>HEA</th>
                                            <th>Tipo de Consulta</th>
                                            <th>Usuario</th>
                                            <th>Acciones</th>
                                        </tr>
                                        </thead>
                                        <tbody>
                                        {% for consulta in consultorio.consultas_remitidas.all %}
                                            <tr>
                                                <td>{{ consulta.created }}</td>
                                                <td>{{ consulta.motivo_de_consulta }}</td>
                                                <td>{{ consulta.HEA }}</td>
                                                <td>{{ consulta.tipo }}</td>
                                                <td>{{ consulta.consultorio.usuario }}</td>
                                                <td><a class="btn btn-primary" href="{% url 'consulta' consulta.id %}">Ver</a></td>
                                            </tr>
                                        {% endfor %}
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        {% endif %}
                    </div>
                </section>
                <aside class="col-md-3">
                    <div class="toolbox col-md-12">
                        <section>
                            <nav class="sidebar-nav">
                                <ul class="nav nav-stacked nav-tabs">
                                    <li>
                                        <a href="{% url 'consultorio-cita-agregar' %}">Crear
                                            una Cita</a>
                                    </li>
                                    <li>
                                        <a href="{% url 'consultorio-report-agregar' consultorio.id %}">
                                            Subir Reporte
                                        </a>
                                    </li>
                                </ul>
                            </nav>
                        </section>
                    </div>
                </aside>
            </div>
            </section>
        </div>
    </div>
    </div>
{% endblock %}
